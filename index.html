<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Video.js VAST Example</title>

    <link href="http://vjs.zencdn.net/4.7.1/video-js.css" rel="stylesheet">
    <link href="lib/videojs-contrib-ads/videojs.ads.css" rel="stylesheet" type="text/css">
    <link href="videojs.vast.css" rel="stylesheet" type="text/css">

    <style type="text/css">
        .description {
            background-color: #eee;
            border: 1px solid #777;
            padding: 10px;
            font-size: .8em;
            line-height: 1.5em;
            font-family: Verdana, sans-serif;
        }

        .example-video-container {
            display: inline-block;
        }
    </style>
    <!--[if lt IE 9]>
    <script src="lib/es5.js"></script>
    <![endif]-->
    <script src="http://vjs.zencdn.net/4.7.1/video.js"></script>
    <script src="lib/videojs-contrib-ads/videojs.ads.js"></script>

    <script src="lib/vast-client.js"></script>
    <script src="videojs.vast.js"></script>
</head>
<body>
<p class="description">Video.js VAST plugin examples.</p>

<div class="example-video-container">
    <p class="description">Advark</p>

    <video id="vid1" class="video-js vjs-default-skin" controls autoplay preload="auto"
           poster="http://video-js.zencoder.com/oceans-clip.png"
           data-setup='{}'
           width='640'
           height='400'
    >
        <source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4'>
        <source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm'>
        <source src="http://video-js.zencoder.com/oceans-clip.ogv" type='video/ogg'>
        <p>Video Playback Not Supported</p>
    </video>
</div>

<div class="example-video-container">
    <p class="description">Sample</p>

    <video id="vid2" class="video-js vjs-default-skin" controls autoplay preload="auto"
           poster="http://video-js.zencoder.com/oceans-clip.png"
           data-setup='{}'
           width='640'
           height='400'
    >
        <source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4'>
        <source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm'>
        <source src="http://video-js.zencoder.com/oceans-clip.ogv" type='video/ogg'>
        <p>Video Playback Not Supported</p>
    </video>
</div>

<script>
    /**
     * Формирование VAST-тэга
     * http://public.advarkads.com/vast?target_id=1&type_id=[type]&id=[id]&referer_url=[referer]&video_id=[video_id]&video_title=[title]&video_page_url=[page]&autoplay=[autoplay]&duration=[duration]
     * Где:
     * [type] - тип запрашиваемой рекламы, одно из следующих значений:
     * 2 - postroll* (линейная реклама)
     * 3 - preroll* (линейная реклама)
     * 4 - тизеры (нелинейная реклама)
     * 5 - видеобаннер (нелинейная реклама)
     * 6 - pauseroll (линейная реклама)
     * 7 - midroll (линейная реклама)
     * 9 - кликандер (линейная реклама)
     * *форматы доступные для flash и html5 видеоплееров

     * [id] - ваш идентификатор в системе Advark
     * [referer] - адрес страницы (с http://), на которой воспроизводится видео в текущий момент. Если он не указан, модуль пытается определить его самостоятельно (что не всегда возможно). При отсутствии или неверном значении данного параметра реклама не воспроизводится.
     * [video_id] - уникальный идентификатор видео на сайте. Любая идентифицирующая строка, постоянная для данного видео и уникальная в рамках данного сайта.
     * [title] - заголовок видео (если имеется). Если нет, параметр можно не передавать.
     * [page] - адрес страницы с видео (с http://). Постоянный адрес по которому данное видео может быть найдено. В некоторых случаях может совпадать со значением [referer].
     * [autoplay] - подставить "1"(без кавычек), если воспроизведение видео началось автоматически, иначе необходимо передать "0" (без кавычек).
     * [duration] - длительность видео в секундах.
     * Все подставленные значения должны быть url-закодированы
     */
    var id = encodeURIComponent('123456'); // ваш идентификатор в системе Advark
    var referer = encodeURIComponent(window.location.href); // адрес страницы (с http://), на которой воспроизводится видео в текущий момент.
    var video_id = encodeURIComponent(window.btoa(encodeURIComponent(window.location.href))); // уникальный идентификатор видео на сайте. Любая идентифицирующая строка, постоянная для данного видео и уникальная в рамках данного сайта.
    var page = referer; // адрес страницы с видео (с http://). Постоянный адрес по которому данное видео может быть найдено. В некоторых случаях может совпадать со значением [referer].
    var autoplay = 0; // подставить 1, если воспроизведение видео началось автоматически, иначе необходимо передать 0
    var duration = 10; // длительность видео в секундах
    var url = 'http://public.advarkads.com/vast?target_id=1&type_id=3&id=' + id +
            '&referer_url=' + referer +
            '&video_id=' + video_id +
            '&video_page_url=' + page +
            '&autoplay=' + autoplay +
            '&duration=' + duration;

    var vid1 = videojs('vid1', {}, function() {
        this.volume(50);
    });
    var vid2 = videojs('vid2', {}, function() {
        this.volume(50);
    });

    vid1.muted(true);
    vid1.ads();
    vid1.vast({
        url: url
    });

    vid2.muted(true);
    vid2.ads();
    vid2.vast({
        url: 'http://videoads.theonion.com/vast/270.xml'
    });
</script>

</body>
</html>